<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>M.A.P.S. EVP Analyzer - Professional Edition</title>

  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">

  <style>
    :root{ --bg:#07080a; --panel:#0f1113; --accent:#00ffd6; --accent-2:#7efc6f; --muted:#9aa6ad; }
    *{box-sizing:border-box}
    html,body{height:100%; margin:0; font-family:Inter, Arial, sans-serif; background: radial-gradient(1000px 400px at 10% 10%, rgba(0,255,214,0.02), transparent), linear-gradient(180deg,var(--bg) 0%, #05050a 100%); color:#e8fbff;}
    .container{ max-width:1200px; margin:20px auto; padding:18px; }

    header{text-align:center; margin-bottom:16px;}
    h1{ font-family: 'Orbitron', sans-serif; color:var(--accent); margin:0; font-size:26px; text-shadow:0 6px 20px rgba(0,255,214,0.05); }

    .upload-zone{
      background: linear-gradient(180deg, rgba(255,255,255,0.012), rgba(255,255,255,0.006));
      border-radius:12px; padding:20px; border:1px solid rgba(0,255,214,0.05);
      text-align:center; cursor:pointer; transition:transform .14s ease, box-shadow .14s ease;
    }
    .upload-zone:hover{ transform:translateY(-4px); box-shadow:0 12px 40px rgba(0,255,214,0.03); border-color:var(--accent); }

    .controls{
      display:flex; gap:10px; flex-wrap:wrap; justify-content:center; margin:14px 0 18px; padding:12px; border-radius:12px; background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent); border:1px solid rgba(255,255,255,0.02);
    }
    button{ background:#121212; color:#eafcff; border:1px solid rgba(255,255,255,0.04); padding:10px 16px; border-radius:8px; cursor:pointer; font-weight:600; transition: all .12s ease; }
    button:hover:not(:disabled){ background:var(--accent); color:#03100b; border-color:var(--accent); box-shadow:0 8px 28px rgba(0,255,214,0.06); }
    button.active{ background:var(--accent); color:#03100b; box-shadow:0 10px 36px rgba(0,255,214,0.07); }

    .viz-container{
      position:relative; height:420px; border-radius:10px; overflow:hidden; border:1px solid rgba(255,255,255,0.03); background:#000;
      box-shadow: inset 0 0 40px rgba(0,0,0,0.6), 0 12px 40px rgba(0,0,0,0.6);
    }
    canvas{ position:absolute; inset:0; width:100%; height:100%; display:block; }

    /* subtle HUD brackets */
    .viz-container::before, .viz-container::after{
      content:""; position:absolute; pointer-events:none; border:2px solid rgba(0,255,214,0.04); inset:8px; border-radius:8px; box-shadow:0 0 40px rgba(0,255,214,0.02);
    }
    .viz-glow{ position:absolute; inset:0; pointer-events:none; box-shadow:0 0 80px rgba(0,255,214,0.02); }

    .status-bar{ margin-top:12px; color:var(--muted); font-family:monospace; text-align:center; }
    .hidden{ display:none; }

    /* responsive */
    @media (max-width:760px){
      .viz-container{ height:300px; }
      h1{ font-size:20px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <header style="text-align:center">
      <h1>üîÆ M.A.P.S. EVP Audio Analyzer</h1>
      <p style="color:var(--muted); margin-top:6px;">Real-time Spectrogram & Frequency Analysis</p>
    </header>

    <div class="upload-zone" onclick="document.getElementById('fileInput').click()">
      <h3 style="margin:0; color:var(--accent);">üìÅ Click to Upload Audio File</h3>
      <p style="color:var(--muted); margin-top:6px;">Supports MP3, WAV, M4A ‚Äî headphones recommended</p>
      <input type="file" id="fileInput" accept="audio/*" style="display:none">
    </div>

    <div class="controls">
      <button id="playBtn" disabled>‚ñ∂ Play / Analyze</button>
      <button id="stopBtn" disabled>‚èπ Stop</button>
      <div style="width:1px; background:rgba(255,255,255,0.02); margin:0 8px;"></div>
      <label style="display:flex; align-items:center; gap:8px; color:var(--muted);">
        <span style="font-weight:600; color:var(--muted);">Sensitivity</span>
        <input type="range" id="gainSlider" min="0" max="300" value="100">
      </label>
      <label style="display:flex; align-items:center; gap:8px; color:var(--muted);">
        <span style="font-weight:600; color:var(--muted);">Speed</span>
        <input type="range" id="speedSlider" min="1" max="10" value="2">
      </label>
    </div>

    <div class="viz-container" aria-hidden="false">
      <canvas id="spectrogramCanvas"></canvas>
      <canvas id="waveformCanvas"></canvas>
      <div class="viz-glow"></div>
    </div>

    <div class="status-bar" id="status">Waiting for file...</div>
  </div>

  <!-- Your original visualizer JS remains unchanged. Paste the script block from your file below. -->
  <script>
    /* Keep the exact script you already have for spectrogram rendering and audio decoding here.
       The markup and canvas IDs remain unchanged so the script will continue to work.
       For brevity in this preview I did not duplicate the whole script; paste your original live-visualizer.js code below.
    */

    // --- Example: small enhancement to ensure canvases match device pixel ratio
    function resizeCanvases() {
      const spectroCanvas = document.getElementById('spectrogramCanvas');
      const waveCanvas = document.getElementById('waveformCanvas');
      const width = spectroCanvas.clientWidth;
      const height = spectroCanvas.clientHeight;
      spectroCanvas.width = width * devicePixelRatio;
      spectroCanvas.height = height * devicePixelRatio;
      waveCanvas.width = width * devicePixelRatio;
      waveCanvas.height = height * devicePixelRatio;
      // scale contexts
      const ctxS = spectroCanvas.getContext('2d');
      const ctxW = waveCanvas.getContext('2d');
      if (ctxS) ctxS.setTransform(devicePixelRatio,0,0,devicePixelRatio,0,0);
      if (ctxW) ctxW.setTransform(devicePixelRatio,0,0,devicePixelRatio,0,0);
    }
    window.addEventListener('resize', () => { resizeCanvases(); });
    // call once initially (the original script should also call resize)
    resizeCanvases();
  </script>
</body>
</html>